import notears
import numpy as np
from notears import utils
from notears.linear import notears_linear

def notears_setup(train_data_numpy, training_n, test_n):
    nt_sampling = notears_linear(train_data_numpy[0:100], lambda1=0.01, loss_type='logistic')
    nt_sampling_train = utils.simulate_linear_sem(nt_sampling, training_n, 'logistic')
    nt_sampling_test = utils.simulate_linear_sem(nt_sampling, test_n, 'logistic')
    np.savetxt('W_est_train.csv', nt_sampling_train, delimiter=',')
    np.savetxt('W_est_test.csv', nt_sampling_test, delimiter=',')
